import{_ as e}from"./chunks/debug3.CsZGeEEI.js";import{_ as i,i as a,o as t,a9 as n}from"./chunks/framework.BpNtyAX8.js";const l="/assets/debug.DcBBmKmx.png",r="/assets/debug2.CMY0mAw3.png",b=JSON.parse('{"title":"Debug Move","description":"","frontmatter":{},"headers":[],"relativePath":"sui/advanced/debug_move.md","filePath":"sui/advanced/debug_move.md","lastUpdated":null}'),h={name:"sui/advanced/debug_move.md"};function o(p,s,d,k,g,c){return t(),a("div",null,s[0]||(s[0]=[n('<h1 id="debug-move" tabindex="-1">Debug Move <a class="header-anchor" href="#debug-move" aria-label="Permalink to &quot;Debug Move&quot;">​</a></h1><h2 id="move-trace-debugger" tabindex="-1">Move Trace Debugger <a class="header-anchor" href="#move-trace-debugger" aria-label="Permalink to &quot;Move Trace Debugger&quot;">​</a></h2><h3 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h3><ul><li><p>vscode<br><a href="https://code.visualstudio.com/download" target="_blank" rel="noreferrer">https://code.visualstudio.com/download</a></p></li><li><p>Move Trace Debugger<br><a href="https://marketplace.visualstudio.com/items?itemName=mysten.move-trace-debug" target="_blank" rel="noreferrer">https://marketplace.visualstudio.com/items?itemName=mysten.move-trace-debug</a></p></li></ul><h3 id="start-debug" tabindex="-1">Start Debug <a class="header-anchor" href="#start-debug" aria-label="Permalink to &quot;Start Debug&quot;">​</a></h3><ul><li>in <code>deepmove</code> cli, type <code>debug &lt;module&gt; &lt;func&gt;</code> to generate trace file as example, you can type the following commands</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">debug</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> wasm_test</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> use_const</span></span></code></pre></div><ul><li>in vscode open the move source code file</li><li>Select <strong>Run</strong> -&gt; <strong>Start Debugging</strong> from the menu. <img src="'+l+'" alt="debug.png"></li></ul><p><img src="'+r+'" alt="debug2.png"></p><h2 id="move-source-mapping" tabindex="-1">Move Source Mapping <a class="header-anchor" href="#move-source-mapping" aria-label="Permalink to &quot;Move Source Mapping&quot;">​</a></h2><p>when your move contracts abort with error codes, in this move example, will abort with <code>assert!</code>, you may get the following error messages</p><p><img src="'+e+`" alt="debug3.png"></p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">VMError</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> with</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> status</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ABORTED</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> with</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sub</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> status</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> at</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> location</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Module</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ModuleId</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> address:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 0000000000000000000000000000000000000000000000000000000000000000,</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Identifier</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">&quot;wasm_test&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> }</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> and</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> message</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 0x0000000000000000000000000000000000000000000000000000000000000000::wasm_test::get_vec</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> at</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> offset</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 19</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> at</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> code</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> offset</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 19</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> in</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> function</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> definition</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 4</span></span></code></pre></div><p>as we can see, it is not quite easy to locate the wrong code position</p><p>will deepmove move vm runtime, you will get the extra message with source mapping to the original wrong code position</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;" tabindex="0"><code><span class="line"><span> → VMError with status ABORTED with sub status 1 at location Module ModuleId { address: 0000000000000000000000000000000000000000000000000000000000000000, name: Identifier(&quot;wasm_test&quot;) } and message 0x0000000000000000000000000000000000000000000000000000000000000000::wasm_test::get_vec at offset 19 at code offset 19 in function definition 4</span></span>
<span class="line"><span></span></span>
<span class="line"><span>move code error at:</span></span>
<span class="line"><span>0x0::wasm_test:59</span></span>
<span class="line"><span>59|    assert</span></span></code></pre></div><p><code>59</code> shows the source code line number to your move codes</p><h2 id="references" tabindex="-1">References <a class="header-anchor" href="#references" aria-label="Permalink to &quot;References&quot;">​</a></h2><p><a href="https://docs.sui.io/references/ide/debugger" target="_blank" rel="noreferrer">https://docs.sui.io/references/ide/debugger</a></p>`,19)]))}const f=i(h,[["render",o]]);export{b as __pageData,f as default};
